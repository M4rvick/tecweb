<!DOCTYPE html>
<html lang="eS">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Producto - Celulares</title>
    <style type="text/css">
        ol,
        ul {
            list-style-type: none;
        }

        label,
        input[type="text"],
        input[type="number"],
        textarea {
            display: block;
            width: 20%;
            /* Opcional: Hace que los campos tomen el ancho completo */
            box-sizing: border-box;
            /* Opcional: Asegura que padding y border no aumenten el ancho */
            margin-bottom: 5px;
            /* Opcional: Espacio extra debajo del elemento */
        }
    </style>
</head>

<body>
    <h1>Formulario para inserción de Celulares</h1>
    <p>A continuación, inserte los datos del producto:</p>
    <form id="formSetProduct" action="http://localhost/tecweb/practicas/p10/set_producto_v2.php" method="post"
        onsubmit="return validarFormulario();">
        <ul>
            <li><label for="nombre">Nombre del producto:</label>
                <input type="text" name="nombre" id="nombre" required>
            </li>

            <li>
                <label for="marca">Marca:</label>
                <select name="marca" id="marca" required>
                    <option value="">-- Seleccione una marca --</option>
                    <option value="Apple">Apple</option>
                    <option value="Samsung">Samsung</option>
                    <option value="Google">Google</option>
                    <option value="Xiaomi">Xiaomi</option>
                    <option value="Motorola">Motorola</option>
                </select>
            </li>

            <li><label for="modelo">Modelo:</label>
                <input type="text" name="modelo" id="modelo" required>
            </li>

            <li><label for="precio">Precio:</label>
                <input type="number" step="0.01" name="precio" id="precio" required>
            </li>

            <li><label for="detalles">Inserte detalles:</label>
                <textarea name="detalles" id="detalles" rows="4"></textarea>
            </li>

            <li><label for="unidades">Unidades:</label>
                <input type="number" name="unidades" id="unidades" required>
            </li>

            <li><label for="imagen">Imagen:</label>
                <input type="text" name="imagen" id="imagen">
            </li>

            <li>
                <input type="submit" value="Insertar en DB">
                <input type="reset" value="Reiniciar">
            </li>
        </ul>
    </form>

    <script>
        function validarFormulario() {
            //array para los errores
            let errores = [];
            const nombre = document.getElementById('nombre').value.trim();
            const marca = document.getElementById('marca').value;
            const modelo = document.getElementById('modelo').value.trim();
            const precio = document.getElementById('precio').value;
            const detalles = document.getElementById('detalles').value.trim();
            const unidades = document.getElementById('unidades').value;
            const imagenInput = document.getElementById('imagen');

            //validacion del nombre
            if (nombre === "") {
                errores.push("El nombre del producto es requerido.");
            } else if (nombre.length > 100) {
                errores.push("El nombre no puede tener más de 100 caracteres.");
            }

            // validacion de la marca
            if (marca === "") {
                errores.push("Debe seleccionar una marca.");
            }

            // validacion del modelo
            const modeloRegex = /^[a-zA-Z0-9\s\-]+$/; // Permite letras, números, espacios y guiones
            if (modelo === "") {
                errores.push("El modelo es requerido.");
            } else if (modelo.length > 25) {
                errores.push("El modelo no puede tener más de 25 caracteres.");
            } else if (!modeloRegex.test(modelo)) {
                errores.push("El modelo solo puede contener caracteres alfanuméricos, espacios y guiones.");
            }

            // validacion del precio 
            if (precio === "") {
                errores.push("El precio es requerido.");
            } else if (parseFloat(precio) <= 99.99) {
                errores.push("El precio debe ser mayor a $99.99.");
            }

            // validacion de los detalles
            if (detalles.length > 250) {
                errores.push("Los detalles no pueden exceder los 250 caracteres.");
            }

            // validacionde las unidades
            if (unidades === "") {
                errores.push("El número de unidades es requerido.");
            } else if (parseInt(unidades, 10) < 0) {
                errores.push("Las unidades no pueden ser un número negativo.");
            }

            // asigancion por defecto de la imagen 
            if (errores.length === 0) {
                // Si la ruta de la imagen está vacía, se asigna una por defecto.
                if (imagenInput.value.trim() === '') {
                    imagenInput.value = 'img/default.jpg';
                }
                alert("¡Validación exitosa! Enviando datos al servidor...");
                return true; // Permite el envío del formulario.
            } else {
                // Si hay errores, se muestran en una sola alerta y se detiene el envío.
                alert("Por favor, corrija los siguientes errores:\n\n" + errores.join("\n"));
                return false; // Detiene el envío del formulario.
            }
        }
    </script>

</body>

</html>